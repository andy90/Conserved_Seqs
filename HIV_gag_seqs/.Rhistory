rm(list = ls())
library(tidyverse)
library(seqinr)
library(foreach)
library(Biostrings)
library(msa)
library(here)
vp_msa <- as.character(read.fasta("p24_aligned.fasta",  seqonly = TRUE))
vp_msa_aligned <- do.call(rbind, str_split(vp_msa, pattern = ""))
gap_percent <- colSums(vp_msa_aligned == "-")/nrow(vp_msa_aligned)
sum(gap_percent > 0.125) # same criteria used by Ferguson
gap_position <- which(gap_percent > 0.125)
vp_msa_aligned <- vp_msa_aligned[, -gap_position]
str(vp_msa_aligned)
AAfreq <-
apply(vp_msa_aligned, 2, function(seq){
a_table <- sort(table(seq), decreasing = TRUE)
a_table[1]/nrow(vp_msa_aligned)
})
AA_mostcommon <-
apply(vp_msa_aligned, 2, function(seq){
a_table <- sort(table(seq), decreasing = TRUE)
names(a_table)[1]
})
AA_mostcommon
AAfreq
ind_conserved <- which(AAfreq > 0.9)
ind_conserved_consecutive <- split(ind_conserved, cumsum(c(1, diff(ind_conserved) != 1)))
ind_conserved_consecutive
AA_consect <-
foreach(i = 1:length(ind_conserved_consecutive), .combine = "c") %do% {
seq <- NULL
if (length(ind_conserved_consecutive[[i]]) >= 5){
seq <- AA_mostcommon[ind_conserved_consecutive[[i]]]
names(seq) <- ind_conserved_consecutive[[i]]
}
list(seq)
}
AA_consect[sapply(AA_consect, is.null)] <- NULL
AA_consect
source('~/Documents/HIV_gag_seqs/p17_conserved.R')
AA_consect
saveRDS(AA_consect, file = "p17_conserved")
saveRDS(AA_consect, file = "p24_conserved")
library(qualV)
install.packages("qualV")
library(qualV)
source('~/Documents/HIV_gag_seqs/shared_HIV_SIV.R')
p17_conserved <- readRDS("p17_conserved")
p24_conserved <- readRDS("p24_conserved")
siv_gag_conserved <- readRDS("siv_gag_conserved")
View(p24_conserved)
View(p17_conserved)
View(p24_conserved)
source('~/Documents/HIV_gag_seqs/p24_conserved.R')
source('~/Documents/HIV_gag_seqs/p17_conserved.R')
source('~/Documents/HIV_gag_seqs/shared_HIV_SIV.R')
LCS(a = c(1,2,3,5,8), b = c(4, 2, 3, 5, 6))
LCS(a = c("1","2","3","5","8"), b = c("4", "2", "3", "5", "6"))
a <- LCS(a = c("1","2","3","5","8"), b = c("4", "2", "3", "5", "6"))
a <- LCS(a = c("1","2","3","5","8"), b = c( "2", "3", "5", "6"))
p17_overlapned <- list()
p17_overlaped <- list()
p17_overlaped
for (i_p17 in p17_conserved){
for (i_siv in siv_gag_conserved){
i_overlaped <- LCS(i_p17, i_siv)$LCS
if (length(i_overlaped) >= 5){
p17_overlaped <- c(p17_overlaped, list(i_overlaped))
}
}
}
for (i_p17 in p17_conserved){
for (i_siv in siv_gag_conserved){
i_overlaped <- LCS(i_p17, i_siv)$LCS
#if (length(i_overlaped) >= 5){
p17_overlaped <- c(p17_overlaped, list(i_overlaped))
#}
}
}
View(p17_overlaped)
p24_overlaped <- list()
for (i_p24 in p24_conserved){
for (i_siv in siv_gag_conserved){
i_overlaped <- LCS(i_p24, i_siv)$LCS
if (length(i_overlaped) >= 5){
p24_overlaped <- c(p24_overlaped, list(i_overlaped))
}
}
}
p24_overlaped
View(p24_overlaped)
source('~/Documents/HIV_gag_seqs/p24_conserved.R')
AA_consect
source('~/Documents/HIV_gag_seqs/p17_conserved.R')
source('~/Documents/HIV_gag_seqs/shared_HIV_SIV.R')
View(p24_overlaped)
saveRDS(p24_overlaped, file = "siv_hiv_p24_conserved_overlaped")
read.table("immunogen.txt")
read.table("immunogen.txt")$V1
immuno_seq <- read.table("immunogen.txt")$V1
immuno_seq <- read.table("immunogen.txt", stringsAsFactors = FALSE, header = FALSE)$V1
immunogen <- read.table("immunogen.txt", stringsAsFactors = FALSE, header = FALSE)$V1
source('~/Documents/HIV_gag_seqs/immunogen_overlap.R')
immuno_seq <- str_split(immunogen, pattern = "")[[1]]
p24_conserved_overlaped <- readRDS("siv_hiv_p24_conserved_overlaped")
overlaped <- list()
for(i_p24 in p24_conserved_overlaped){
i_overlaped <- LCS(i_p24,immuno_seq)$LCS
overlaped <- c(overlaped, list(i_overlaped))
}
View(overlaped)
View(p24_conserved_overlaped)
overlaped <- as.character()
for(i_p24 in p24_conserved_overlaped){
i_overlaped <- LCS(i_p24,immuno_seq)$LCS
overlaped <- c(overlaped, paste(i_overlaped, collapse = ""))
}
overlaped
rm(list = ls())
library(qualV)
library(tidyverse)
library(seqinr)
library(foreach)
library(Biostrings)
library(here)
immunogen <- read.table("immunogen_shuffled.txt", stringsAsFactors = FALSE, header = FALSE)$V1
immuno_seq <- str_split(immunogen, pattern = "")[[1]]
source('~/Documents/HIV_gag_seqs/immunogen_shuffled_overlap.R')
View(p24_conserved_overlaped)
library(tidyverse)
H_SL <- read.table("HIV_SPRTL.txt", stringsAsFactors = FALSE)
View(H_SL)
H_SL <- read_file("HIV_SPRTL.txt", stringsAsFactors = FALSE)
H_SL <- read_file("HIV_SPRTL.txt")
H_SL
gsub("\\{|\\}", "", H_SL)
a <- gsub("\\{|\\}", "", H_SL)
as.character(a)
a <- gsub("\\{|\\}|\\n", "", H_SL)
a
as.character(a)
library(stringr)
str_split(a, " ")
str_split(a, " ")[[1]]
as.numeric(str_split(a, " ")[[1]])
r_H_SL <- as.numeric(str_split(a, " ")[[1]])
S_SL <- read_file("SIV_SPRTL.txt")
a <- gsub("\\{|\\}|\\n", "", S_SL)
a
r_S_SL <- as.numeric(str_split(a, " ")[[1]])
rm(list = ls())
library(tidyverse)
library(stringr)
H_SL <- read_file("HIV_SPRTL.txt")
a <- gsub("\\{|\\}|\\n", "", H_SL)
r_H_SL <- as.numeric(str_split(a, " ")[[1]])
source('~/Documents/HIV_gag_seqs/getRMSD.R')
(r_H_SL - r_S_SL)**2
sqrt(sum((r_H_SL - r_S_SL)**2)/(length(r_H_SL)/3))
H_NA <- read_file("HIV_NEEAA.txt")
a <- gsub("\\{|\\}|\\n", "", H_NA)
r_H_NA <- as.numeric(str_split(a, " ")[[1]])
S_NA <- read_file("SIV_SPRTL.txt")
a <- gsub("\\{|\\}|\\n", "", S_NA)
r_S_NA <- as.numeric(str_split(a, " ")[[1]])
sqrt(sum((r_H_NA - r_S_NA)**2)/(length(r_H_NA)/3))
H_NA <- read_file("HIV_NEEAA.txt")
a <- gsub("\\{|\\}|\\n", "", H_NA)
r_H_NA <- as.numeric(str_split(a, " ")[[1]])
S_NA <- read_file("SIV_NEEAA.txt")
a <- gsub("\\{|\\}|\\n", "", S_NA)
r_S_NA <- as.numeric(str_split(a, " ")[[1]])
sqrt(sum((r_H_NA - r_S_NA)**2)/(length(r_H_NA)/3))
H_GS <- read_file("HIV_GS.txt")
a <- gsub("\\{|\\}|\\n", "", H_GS)
r_H_GS <- as.numeric(str_split(a, " ")[[1]])
S_GS <- read_file("SIV_GS.txt")
a <- gsub("\\{|\\}|\\n", "", S_GS)
r_S_GS <- as.numeric(str_split(a, " ")[[1]])
sqrt(sum((r_H_GS - r_S_GS)**2)/(length(r_H_GS)/3))
